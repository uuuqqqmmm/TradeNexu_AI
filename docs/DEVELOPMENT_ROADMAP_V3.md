# TradeNexus AI v3.0 å¼€å‘è·¯çº¿å›¾
## TradeNexus Station - å•æœºå…¨æ ˆæ¶æ„æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: v3.0  
> **æ›´æ–°æ—¥æœŸ**: 2025-12-12  
> **ç›®æ ‡**: ä»"ä¿¡æ¯æŸ¥è¯¢åŸå‹"å‡çº§ä¸º"ä¸šåŠ¡é—­ç¯å•†ä¸šçº§è½¯ä»¶"

---

## ğŸ“‹ ç›®å½•

1. [æˆ˜ç•¥è§„åˆ’](#1-æˆ˜ç•¥è§„åˆ’)
2. [ç³»ç»Ÿæ¶æ„å‡çº§](#2-ç³»ç»Ÿæ¶æ„å‡çº§)
3. [æŠ€æœ¯æ ˆé€‰å‹](#3-æŠ€æœ¯æ ˆé€‰å‹)
4. [æ™ºèƒ½ä½“åŠŸèƒ½å¼€å‘è®¡åˆ’](#4-æ™ºèƒ½ä½“åŠŸèƒ½å¼€å‘è®¡åˆ’)
5. [äº¤äº’ä½“éªŒä¼˜åŒ–](#5-äº¤äº’ä½“éªŒä¼˜åŒ–)
6. [å¼€å‘è·¯çº¿å›¾](#6-å¼€å‘è·¯çº¿å›¾)
7. [æ•°æ®åº“è®¾è®¡](#7-æ•°æ®åº“è®¾è®¡)
8. [ç°æœ‰ä»£ç ä¿®æ”¹æ¸…å•](#8-ç°æœ‰ä»£ç ä¿®æ”¹æ¸…å•)

---

## 1. æˆ˜ç•¥è§„åˆ’

### 1.1 æ ¸å¿ƒæˆ˜ç•¥è°ƒæ•´

| ç»´åº¦ | å½“å‰çŠ¶æ€ (v2.0) | ç›®æ ‡çŠ¶æ€ (v3.0) |
|------|----------------|----------------|
| **è¾“å…¥ç«¯** | Amazon/TikTok æ•°æ®æŸ¥è¯¢ | + 1688/Alibaba ä¾›åº”é“¾æ•°æ® |
| **è¾“å‡ºç«¯** | Amazon/TikTok | + Shopee/Lazada (ä¸œå—äºš) |
| **ä¸­é—´å±‚** | ä¸´æ—¶èŠå¤©è®°å½• | æŒä¹…åŒ–ä¸šåŠ¡å¯¹è±¡ (Project/SKU) |
| **æ¶æ„** | çº¯å‰ç«¯ Client-side | å…¨æ ˆ Docker å®¹å™¨åŒ– |

### 1.2 ä¸šåŠ¡é—­ç¯ç›®æ ‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TradeNexus AI v3.0 ä¸šåŠ¡é—­ç¯                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   [é€‰å“å‘ç°]        [è´§æºåŒ¹é…]        [åˆè§„æ£€æŸ¥]        [é”€å”®è½¬åŒ–]   â”‚
â”‚       â†“                â†“                â†“                â†“      â”‚
â”‚   Amazon/TikTok  â†’  1688ä»¥å›¾æœå›¾  â†’  HSç¼–ç /è®¤è¯  â†’  å¤šè¯­è¨€å¼€å‘ä¿¡   â”‚
â”‚   è¶‹åŠ¿åˆ†æ           åˆ©æ¶¦è¯•ç®—         é£é™©è¯„ä¼°         ç¤¾åª’æŒ–æ˜     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ç³»ç»Ÿæ¶æ„å‡çº§

### 2.1 æ¶æ„å¯¹æ¯”

| ç‰¹æ€§ | v2.0 (å½“å‰) | v3.0 (ç›®æ ‡) |
|------|------------|------------|
| API Key å­˜å‚¨ | å‰ç«¯ .env (ä¸å®‰å…¨) | åç«¯ç¯å¢ƒå˜é‡ |
| æ•°æ®æŒä¹…åŒ– | localStorage | PostgreSQL |
| é•¿æ—¶ä»»åŠ¡ | å‰ç«¯ç­‰å¾… | BullMQ é˜Ÿåˆ— |
| çˆ¬è™«èƒ½åŠ› | æ—  | Puppeteer + Stealth |
| AI å¢å¼º | é€šç”¨ Prompt | RAG + å‘é‡çŸ¥è¯†åº“ |

### 2.2 ç³»ç»Ÿæ‹“æ‰‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TradeNexus Station (æœ¬åœ°æœåŠ¡å™¨)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   ç”¨æˆ·æµè§ˆå™¨ â”€â”€HTTP:80â”€â”€â†’ [Nginx ç½‘å…³]                                â”‚
â”‚                              â”‚                                      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â†“                   â†“                            â”‚
â”‚              [React å‰ç«¯]        [Nest.js API]                       â”‚
â”‚              (é™æ€èµ„æº)               â”‚                              â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                              â†“       â†“       â†“                      â”‚
â”‚                         [PostgreSQL] [Redis] [pgvector]             â”‚
â”‚                              â”‚       â”‚                              â”‚
â”‚                              â”‚   [BullMQ é˜Ÿåˆ—]                       â”‚
â”‚                              â”‚       â”‚                              â”‚
â”‚                              â”‚   â”Œâ”€â”€â”€â”´â”€â”€â”€â”                          â”‚
â”‚                              â”‚   â†“       â†“                          â”‚
â”‚                              â”‚ [çˆ¬è™«Worker] [ç›‘æ§Worker]              â”‚
â”‚                              â”‚   â”‚                                  â”‚
â”‚                              â”‚   â†“                                  â”‚
â”‚                              â”‚ [Headless Chrome]                    â”‚
â”‚                              â”‚   â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“          â†“              â†“
              [Gemini API] [Amazon] [1688/TikTok]
```

---

## 3. æŠ€æœ¯æ ˆé€‰å‹

### 3.1 å•æœºç‰ˆæŠ€æœ¯æ ˆ

| æ¨¡å— | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | ç†ç”± |
|------|---------|------|------|
| **OS** | Ubuntu 22.04 / Windows WSL2 | - | æœ€ä½³æœåŠ¡å™¨ç¯å¢ƒ |
| **å®¹å™¨** | Docker + Docker Compose | 24.x | ä¸€é”®éƒ¨ç½²ï¼Œç¯å¢ƒéš”ç¦» |
| **å‰ç«¯** | React + Vite + TailwindCSS | ç°æœ‰ | ä¿æŒç°æœ‰æ¶æ„ |
| **åç«¯** | Nest.js (TypeScript) | 10.x | ä¼ä¸šçº§æ¡†æ¶ï¼Œæ¨¡å—åŒ– |
| **æ•°æ®åº“** | PostgreSQL + pgvector | 16 | å…³ç³»å­˜å‚¨ + å‘é‡æ£€ç´¢ |
| **ORM** | Prisma | 5.x | ç±»å‹å®‰å…¨ï¼Œè¿ç§»æ–¹ä¾¿ |
| **ç¼“å­˜/é˜Ÿåˆ—** | Redis + BullMQ | 7.x | å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ— |
| **çˆ¬è™«** | Puppeteer + Stealth | 22.x | æµè§ˆå™¨è‡ªåŠ¨åŒ– |
| **ç½‘å…³** | Nginx | alpine | é™æ€æ‰˜ç®¡ + åå‘ä»£ç† |

### 3.2 Docker Compose é…ç½®

```yaml
# docker-compose.yml
version: '3.8'

services:
  # 1. æ•°æ®åº“æœåŠ¡
  postgres:
    image: postgres:16-alpine
    container_name: tradenexus_db
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: ${DB_PASSWORD}
      POSTGRES_DB: tradenexus
    volumes:
      - ./data/postgres:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    restart: always
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U admin -d tradenexus"]
      interval: 10s
      timeout: 5s
      retries: 5

  # 2. æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡
  redis:
    image: redis:7-alpine
    container_name: tradenexus_redis
    ports:
      - "6379:6379"
    volumes:
      - ./data/redis:/data
    restart: always

  # 3. åç«¯ API æœåŠ¡
  backend:
    build: ./backend
    container_name: tradenexus_api
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_started
    environment:
      DATABASE_URL: postgresql://admin:${DB_PASSWORD}@postgres:5432/tradenexus
      REDIS_URL: redis://redis:6379
      GEMINI_API_KEY: ${GEMINI_API_KEY}
      APIFY_TOKEN: ${APIFY_TOKEN}
      NODE_ENV: production
    ports:
      - "3000:3000"
    restart: always

  # 4. çˆ¬è™« Worker æœåŠ¡
  crawler:
    build: ./backend
    container_name: tradenexus_crawler
    command: npm run worker:crawler
    depends_on:
      - redis
      - postgres
    environment:
      DATABASE_URL: postgresql://admin:${DB_PASSWORD}@postgres:5432/tradenexus
      REDIS_URL: redis://redis:6379
    restart: always

  # 5. å‰ç«¯é™æ€æ‰˜ç®¡
  frontend:
    image: nginx:alpine
    container_name: tradenexus_ui
    volumes:
      - ./frontend/dist:/usr/share/nginx/html
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    ports:
      - "80:80"
    depends_on:
      - backend
    restart: always
```

---

## 4. æ™ºèƒ½ä½“åŠŸèƒ½å¼€å‘è®¡åˆ’

### 4.1 ä¾›åº”é“¾æ€»ç›‘ (Supply Chain Director) - P0 ä¼˜å…ˆçº§

> ğŸ¯ **æ ¸å¿ƒç›®æ ‡**: è¿æ¥"ä¸­å›½åˆ¶é€ "ï¼Œè§£å†³"è´§ä»å“ªæ¥"

#### åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ | å¤æ‚åº¦ |
|------|------|--------|--------|
| 1688 ä»¥å›¾æœå›¾ | ç”¨ Amazon äº§å“å›¾åœ¨ 1688 æ‰¾åŒæ¬¾ | P0 | é«˜ |
| 1688 å…³é”®è¯æœç´¢ | AI ç¿»è¯‘è‹±æ–‡æ ‡é¢˜ä¸ºä¸­æ–‡æœç´¢è¯ | P0 | ä¸­ |
| åˆ©æ¶¦è¯•ç®—å™¨ | å”®ä»· - é‡‡è´­ä»· - è¿è´¹ - ä½£é‡‘ = å‡€åˆ©æ¶¦ | P0 | ä½ |
| ä¾›åº”å•†è¯„ä¼° | åˆ†æå¼€åº—å¹´é™ã€å›å¤´ç‡ã€å‘è´§é€Ÿåº¦ | P1 | ä¸­ |
| é‡‡è´­å•ç”Ÿæˆ | è‡ªåŠ¨ç”Ÿæˆé‡‡è´­æ¸…å• Excel | P2 | ä½ |

#### åˆ©æ¶¦è®¡ç®—å…¬å¼

```typescript
interface CostStructure {
  sellPrice: number;        // Amazon å”®ä»· (USD)
  costPrice: number;        // 1688 é‡‡è´­ä»· (CNY)
  exchangeRate: number;     // æ±‡ç‡ (é»˜è®¤ 7.2)
  weight: number;           // äº§å“é‡é‡ (kg)
  shippingPerKg: number;    // å¤´ç¨‹è¿è´¹ (CNY/kg)
  amazonReferralFee: number; // ä½£é‡‘æ¯”ä¾‹ (é»˜è®¤ 15%)
  fbaFee: number;           // FBA é…é€è´¹ (USD)
  marketingCost: number;    // å¹¿å‘Šè´¹ (USD)
}

// å‡€åˆ©æ¶¦ = (å”®ä»· Ã— (1 - ä½£é‡‘) - FBAè´¹ - å¹¿å‘Šè´¹) Ã— æ±‡ç‡ - é‡‡è´­ä»· - (é‡é‡ Ã— è¿è´¹)
function calculateProfit(cost: CostStructure): number {
  const grossRevenue = cost.sellPrice * (1 - cost.amazonReferralFee);
  const netRevenueCNY = (grossRevenue - cost.fbaFee - cost.marketingCost) * cost.exchangeRate;
  const totalCost = cost.costPrice + (cost.weight * cost.shippingPerKg);
  return netRevenueCNY - totalCost;
}
```

### 4.2 è´¸æ˜“åˆè§„å®˜ (Compliance Officer) - P1 ä¼˜å…ˆçº§

> ğŸ¯ **æ ¸å¿ƒç›®æ ‡**: é™ä½åˆè§„é£é™©ï¼Œé¿å…è´§ç‰©è¢«æ‰£

#### åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ | æè¿° | å¸‚åœº | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| HS ç¼–ç åŒ¹é… | åŸºäºäº§å“æè¿°æ¨è HS Code | å…¨çƒ | P0 |
| å‡ºå£é€€ç¨è®¡ç®— | æ ¹æ® HS Code è®¡ç®—é€€ç¨ç‡ | ä¸­å›½ | P1 |
| FDA è®¤è¯æ£€æŸ¥ | é£Ÿå“/åŒ–å¦†å“/åŒ»ç–—å™¨æ¢° | ç¾å›½ | P1 |
| CE è®¤è¯æ£€æŸ¥ | ç”µå­äº§å“å®‰å…¨è®¤è¯ | æ¬§æ´² | P1 |
| EPR åŒ…è£…æ³•æ£€æŸ¥ | ç¯ä¿åŒ…è£…åˆè§„ | æ¬§æ´² | P2 |
| æ¸…çœŸè®¤è¯æ£€æŸ¥ | å®—æ•™ç›¸å…³äº§å“ | ä¸œå—äºš | P2 |

#### RAG çŸ¥è¯†åº“æ„å»º

```
knowledge_base/
â”œâ”€â”€ hs_codes/
â”‚   â”œâ”€â”€ china_export_hs_2024.json
â”‚   â””â”€â”€ us_import_tariff.json
â”œâ”€â”€ regulations/
â”‚   â”œâ”€â”€ fda_cosmetics.md
â”‚   â”œâ”€â”€ fda_food.md
â”‚   â”œâ”€â”€ ce_marking_guide.md
â”‚   â””â”€â”€ epr_germany.md
â”œâ”€â”€ certifications/
â”‚   â”œâ”€â”€ cpc_children_products.md
â”‚   â””â”€â”€ halal_certification.md
â””â”€â”€ embeddings/
    â””â”€â”€ pgvector_index.sql
```

### 4.3 å¸‚åœºæƒ…æŠ¥å®˜ (Market Intelligence) - å¢å¼º

> ğŸ¯ **æ ¸å¿ƒç›®æ ‡**: æ‹“å®½æ¸ é“ï¼Œæ·±åº¦åˆ†æ

#### æ–°å¢å¹³å°æ”¯æŒ

| å¹³å° | åœ°åŒº | æ•°æ®ç±»å‹ | ä¼˜å…ˆçº§ |
|------|------|----------|--------|
| Shopee | ä¸œå—äºš | äº§å“/é”€é‡/è¯„è®º | P1 |
| Lazada | ä¸œå—äºš | äº§å“/é”€é‡ | P1 |
| Temu | å…¨çƒ | ä»·æ ¼å¯¹æ¯” | P2 |
| Shein | å…¨çƒ | æ—¶å°šè¶‹åŠ¿ | P2 |

#### åŠŸèƒ½å¢å¼º

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ |
|------|------|--------|
| è¯„è®ºæƒ…æ„Ÿåˆ†æ | æŠ“å–å·®è¯„ï¼ŒAI æ€»ç»“ç—›ç‚¹ | P0 |
| ç«å“ç›‘æ§ | å®šæ—¶ç›‘æ§ ASIN ä»·æ ¼å˜åŒ– | P1 |
| è¶‹åŠ¿é¢„æµ‹ | åŸºäºå†å²æ•°æ®é¢„æµ‹é”€é‡ | P2 |

### 4.4 å®¢æˆ·å¼€å‘å®˜ (Lead Nurturing) - P2 ä¼˜å…ˆçº§

> ğŸ¯ **æ ¸å¿ƒç›®æ ‡**: æå‡ B2B/B2C è½¬åŒ–æ•ˆç‡

#### åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ |
|------|------|--------|
| ç¤¾åª’æŒ–æ˜ | LinkedIn/Instagram/TikTok Hashtag ç›‘æ§ | P1 |
| å¤šè¯­è¨€ç¿»è¯‘ | æ³°è¯­/è¶Šå—è¯­/å°å°¼è¯­å•†åŠ¡æ²Ÿé€š | P1 |
| Cold Email ç”Ÿæˆ | ç¬¦åˆå½“åœ°å•†åŠ¡ç¤¼ä»ªçš„å¼€å‘ä¿¡ | P0 |
| WhatsApp é›†æˆ | Deep Link ä¸€é”®å‘é€ | P2 |

---

## 5. äº¤äº’ä½“éªŒä¼˜åŒ–

### 5.1 ä¸€é”®å¼å·¥ä½œæµ

#### åœºæ™¯ A: çˆ†æ¬¾å¤åˆ»

```
è¾“å…¥: Amazon äº§å“é“¾æ¥
  â†“
[å¸‚åœºæƒ…æŠ¥å®˜] åˆ†æç«å“æ•°æ®
  â†“
[ä¾›åº”é“¾æ€»ç›‘] 1688 æ‰¾åŒæ¬¾ + åˆ©æ¶¦è®¡ç®—
  â†“
[è´¸æ˜“åˆè§„å®˜] æ£€æŸ¥è®¤è¯è¦æ±‚
  â†“
è¾“å‡º: ã€Šå¯è¡Œæ€§åˆ†ææŠ¥å‘Šã€‹PDF
```

#### åœºæ™¯ B: åº“å­˜æ¸…ä»“

```
è¾“å…¥: äº§å“å›¾ç‰‡ + åº“å­˜é‡
  â†“
[å¸‚åœºæƒ…æŠ¥å®˜] åˆ†æ TikTok è¶‹åŠ¿
  â†“
[å®¢æˆ·å¼€å‘å®˜] ç”ŸæˆçŸ­è§†é¢‘è„šæœ¬ + æ¨èè¾¾äºº
  â†“
è¾“å‡º: ã€Šæ¸…ä»“è¥é”€æ–¹æ¡ˆã€‹
```

### 5.2 æ–°å¢é¡µé¢

| é¡µé¢ | åŠŸèƒ½ | ä¼˜å…ˆçº§ |
|------|------|--------|
| **äº§å“åº“ (My Products)** | ERP å¼äº§å“ç®¡ç†ï¼Œæ˜¾ç¤ºåˆ©æ¶¦ç‡/é£é™©ç­‰çº§ | P0 |
| **ä»»åŠ¡ä¸­å¿ƒ (Task Center)** | ç›‘æ§ä»»åŠ¡ã€å¾…åŠäº‹é¡¹ã€åˆè§„å®¡æ ¸ | P1 |
| **ä¾›åº”å•†åº“ (Suppliers)** | æ”¶è—çš„ 1688 ä¾›åº”å•†ç®¡ç† | P1 |
| **æŠ¥å‘Šä¸­å¿ƒ (Reports)** | å†å²åˆ†ææŠ¥å‘Šå­˜æ¡£ | P2 |

---

## 6. å¼€å‘è·¯çº¿å›¾

### 6.1 Phase 3: é—­ç¯åŸºç¡€ (6 å‘¨)

#### Sprint 1: åç«¯åœ°åŸº (Week 1-2)

| ä»»åŠ¡ | æè¿° | è´Ÿè´£äºº | çŠ¶æ€ |
|------|------|--------|------|
| 3.1.1 | Docker Compose ç¯å¢ƒæ­å»º | - | â¬œ |
| 3.1.2 | Nest.js é¡¹ç›®åˆå§‹åŒ– + Prisma é…ç½® | - | â¬œ |
| 3.1.3 | è¿ç§» Gemini Service åˆ°åç«¯ | - | â¬œ |
| 3.1.4 | å‰ç«¯æ”¹ä¸ºè°ƒç”¨ `/api/analyze` | - | â¬œ |
| 3.1.5 | JWT è®¤è¯ç³»ç»Ÿ (ç®€å•ç™»å½•) | - | â¬œ |
| 3.1.6 | æ•°æ®åº“ Schema è®¾è®¡ | - | â¬œ |

#### Sprint 2: ä¾›åº”é“¾æ•°æ®è·å– (Week 3-4)

| ä»»åŠ¡ | æè¿° | è´Ÿè´£äºº | çŠ¶æ€ |
|------|------|--------|------|
| 3.2.1 | Puppeteer åŸºç¡€æœåŠ¡é›†æˆ | - | â¬œ |
| 3.2.2 | 1688 ä»¥å›¾æœå›¾åŠŸèƒ½å¼€å‘ | - | â¬œ |
| 3.2.3 | BullMQ é˜Ÿåˆ—å®ç° | - | â¬œ |
| 3.2.4 | çˆ¬è™«é£æ§å¤„ç† (ä»£ç†/é¢‘ç‡) | - | â¬œ |
| 3.2.5 | 1688Service.ts å¼€å‘ | - | â¬œ |

#### Sprint 3: ä¸šåŠ¡é—­ç¯ä¸æŒä¹…åŒ– (Week 5-6)

| ä»»åŠ¡ | æè¿° | è´Ÿè´£äºº | çŠ¶æ€ |
|------|------|--------|------|
| 3.3.1 | Products è¡¨ CRUD API | - | â¬œ |
| 3.3.2 | SourcingResults å…³è”å­˜å‚¨ | - | â¬œ |
| 3.3.3 | åˆ©æ¶¦è¯•ç®—å™¨ API | - | â¬œ |
| 3.3.4 | å‰ç«¯"äº§å“è¯¦æƒ…é¡µ"å¼€å‘ | - | â¬œ |
| 3.3.5 | Dashboard äº§å“çœ‹æ¿ | - | â¬œ |

### 6.2 Phase 4: åˆè§„ä¸å¤šå¸‚åœº (4 å‘¨)

| ä»»åŠ¡ | æè¿° | çŠ¶æ€ |
|------|------|------|
| 4.1 | RAG å‘é‡çŸ¥è¯†åº“æ­å»º (pgvector) | â¬œ |
| 4.2 | è´¸æ˜“åˆè§„å®˜æ™ºèƒ½ä½“å¼€å‘ | â¬œ |
| 4.3 | HS ç¼–ç åŒ¹é…åŠŸèƒ½ | â¬œ |
| 4.4 | Shopee/Lazada æ•°æ®æºé›†æˆ | â¬œ |
| 4.5 | å¤šè¯­è¨€ UI æ”¯æŒ (ä¸­/è‹±) | â¬œ |

### 6.3 Phase 5: CRM ä¸è‡ªåŠ¨åŒ– (4 å‘¨)

| ä»»åŠ¡ | æè¿° | çŠ¶æ€ |
|------|------|------|
| 5.1 | å®¢æˆ·å¼€å‘å®˜æ™ºèƒ½ä½“å¼€å‘ | â¬œ |
| 5.2 | AI é‚®ä»¶/è„šæœ¬ç”Ÿæˆ | â¬œ |
| 5.3 | PDF/Excel æŠ¥å‘Šå¯¼å‡º | â¬œ |
| 5.4 | ç§»åŠ¨ç«¯é€‚é… | â¬œ |
| 5.5 | å®šæ—¶ä»»åŠ¡ (ä»·æ ¼ç›‘æ§) | â¬œ |

---

## 7. æ•°æ®åº“è®¾è®¡

### 7.1 æ ¸å¿ƒè¡¨ç»“æ„

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  name VARCHAR(100),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- äº§å“è¡¨ (é€‰å“æ•°æ®)
CREATE TABLE products (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  platform VARCHAR(50) NOT NULL, -- 'amazon', 'tiktok', 'shopee'
  platform_id VARCHAR(100) NOT NULL, -- ASIN æˆ– Product ID
  title VARCHAR(500) NOT NULL,
  image_url TEXT,
  selling_price DECIMAL(10,2),
  currency VARCHAR(10) DEFAULT 'USD',
  category VARCHAR(200),
  bsr_rank INTEGER,
  review_count INTEGER,
  rating DECIMAL(3,2),
  status VARCHAR(50) DEFAULT 'new', -- 'new', 'analyzed', 'sourced', 'archived'
  ai_analysis JSONB, -- AI åˆ†æç»“æœ
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(platform, platform_id)
);

-- è´§æºè¡¨ (1688 æ•°æ®)
CREATE TABLE sourcing_results (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  product_id UUID REFERENCES products(id) ON DELETE CASCADE,
  supplier_url TEXT NOT NULL,
  supplier_name VARCHAR(200),
  cost_price DECIMAL(10,2) NOT NULL,
  currency VARCHAR(10) DEFAULT 'CNY',
  moq INTEGER, -- æœ€å°èµ·è®¢é‡
  supplier_rating DECIMAL(3,2),
  shop_years INTEGER, -- å¼€åº—å¹´é™
  match_score DECIMAL(3,2), -- AI åŒ¹é…åº¦
  created_at TIMESTAMP DEFAULT NOW()
);

-- åˆ©æ¶¦è®¡ç®—è¡¨
CREATE TABLE profit_calculations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  product_id UUID REFERENCES products(id),
  sourcing_id UUID REFERENCES sourcing_results(id),
  sell_price DECIMAL(10,2),
  cost_price DECIMAL(10,2),
  shipping_cost DECIMAL(10,2),
  platform_fee DECIMAL(10,2),
  fba_fee DECIMAL(10,2),
  marketing_cost DECIMAL(10,2),
  net_profit DECIMAL(10,2),
  profit_margin DECIMAL(5,2), -- ç™¾åˆ†æ¯”
  exchange_rate DECIMAL(6,4),
  created_at TIMESTAMP DEFAULT NOW()
);

-- åˆè§„æ£€æŸ¥è¡¨
CREATE TABLE compliance_checks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  product_id UUID REFERENCES products(id),
  market VARCHAR(50) NOT NULL, -- 'US', 'EU', 'SEA'
  hs_code VARCHAR(20),
  tax_rate DECIMAL(5,2),
  certifications_required TEXT[], -- ['FDA', 'CE', 'CPC']
  risk_level VARCHAR(20), -- 'low', 'medium', 'high'
  ai_notes TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ä»»åŠ¡æ—¥å¿—è¡¨
CREATE TABLE jobs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  type VARCHAR(50) NOT NULL, -- 'AMAZON_SEARCH', '1688_FIND', 'PROFIT_CALC'
  status VARCHAR(50) DEFAULT 'pending', -- 'pending', 'running', 'completed', 'failed'
  input_data JSONB,
  output_data JSONB,
  error_message TEXT,
  started_at TIMESTAMP,
  completed_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

-- å‘é‡ç´¢å¼• (RAG çŸ¥è¯†åº“)
CREATE EXTENSION IF NOT EXISTS vector;

CREATE TABLE knowledge_embeddings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  category VARCHAR(100), -- 'hs_code', 'regulation', 'certification'
  title VARCHAR(500),
  content TEXT,
  embedding vector(1536), -- OpenAI embedding ç»´åº¦
  metadata JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX ON knowledge_embeddings USING ivfflat (embedding vector_cosine_ops);
```

### 7.2 ER å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   users     â”‚       â”‚    products      â”‚       â”‚ sourcing_resultsâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚â”€â”€1:Nâ”€â”€â”‚ id (PK)          â”‚â”€â”€1:Nâ”€â”€â”‚ id (PK)         â”‚
â”‚ email       â”‚       â”‚ user_id (FK)     â”‚       â”‚ product_id (FK) â”‚
â”‚ password    â”‚       â”‚ platform         â”‚       â”‚ supplier_url    â”‚
â”‚ name        â”‚       â”‚ platform_id      â”‚       â”‚ cost_price      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ title            â”‚       â”‚ moq             â”‚
                      â”‚ selling_price    â”‚       â”‚ match_score     â”‚
                      â”‚ status           â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ai_analysis      â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                â”‚                â”‚
              â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚profit_calculationsâ”‚ â”‚compliance_  â”‚ â”‚     jobs        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   checks    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ id (PK)         â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ id (PK)         â”‚
    â”‚ product_id (FK) â”‚ â”‚ id (PK)     â”‚ â”‚ user_id (FK)    â”‚
    â”‚ net_profit      â”‚ â”‚ product_id  â”‚ â”‚ type            â”‚
    â”‚ profit_margin   â”‚ â”‚ hs_code     â”‚ â”‚ status          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ risk_level  â”‚ â”‚ input/output    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ç°æœ‰ä»£ç ä¿®æ”¹æ¸…å•

### 8.1 ç«‹å³æ‰§è¡Œ (Immediate Actions)

| åºå· | æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | ä¼˜å…ˆçº§ |
|------|------|----------|--------|
| 1 | `src/types.ts` | é‡æ„ `AnalysisResult` æ¥å£ï¼Œå¢åŠ  `sourcingInfo` å’Œ `complianceCheck` | P0 |
| 2 | `.env` | API Key ç§»é™¤å‰ç«¯ï¼Œæ”¹ä¸ºåç«¯ä»£ç† | P0 |
| 3 | `src/services/` | æ–°å¢ `1688Service.ts` (Mock æ•°æ®å…ˆè¡Œ) | P0 |
| 4 | `src/services/geminiService.ts` | ä¼˜åŒ– Promptï¼Œå¢åŠ å¤–è´¸ä¸“å®¶ä¸Šä¸‹æ–‡ | P1 |
| 5 | `package.json` | æ·»åŠ åç«¯ä¾èµ– (Nest.js, Prisma, BullMQ) | P0 |

### 8.2 AnalysisResult æ¥å£é‡æ„

```typescript
// src/types.ts - æ–°å¢å­—æ®µ

export interface SourcingInfo {
  supplier_url: string;
  supplier_name: string;
  cost_price: number;
  currency: string;
  moq: number;
  supplier_rating: number;
  match_score: number;
  image_url: string;
}

export interface ComplianceCheck {
  market: 'US' | 'EU' | 'SEA';
  hs_code: string;
  tax_rate: number;
  certifications_required: string[];
  risk_level: 'low' | 'medium' | 'high';
  notes: string;
}

export interface ProfitCalculation {
  sell_price: number;
  cost_price: number;
  shipping_cost: number;
  platform_fee: number;
  fba_fee: number;
  marketing_cost: number;
  net_profit: number;
  profit_margin: number;
  exchange_rate: number;
}

export interface AnalysisResult {
  // ç°æœ‰å­—æ®µ...
  thinking_process: string;
  agentProtocolLogs: AgentProtocolEvent[];
  query: string;
  summary: string;
  strategicAdvice: string;
  trendData: TrendDataPoint[];
  topProducts: ProductInsight[];
  relatedKeywords: string[];
  
  // v3.0 æ–°å¢å­—æ®µ
  sourcingInfo?: SourcingInfo[];      // ä¾›åº”é“¾æ•°æ®
  complianceCheck?: ComplianceCheck;  // åˆè§„æ£€æŸ¥
  profitCalculation?: ProfitCalculation; // åˆ©æ¶¦è®¡ç®—
}
```

### 8.3 Gemini Prompt ä¼˜åŒ–

```typescript
// src/services/geminiService.ts - ä¼˜åŒ– systemPrompt

const systemPrompt = `
ä½ æ˜¯ TradeNexus AI çš„æ ¸å¿ƒæ™ºèƒ½ä½“ - AI æ€»ç®¡ï¼ˆGeneral Managerï¼‰ã€‚

ã€è§’è‰²å®šä½ã€‘
ä½ æ˜¯ä¸€åèµ„æ·±çš„ä¸­å›½å¤–è´¸ä¸“å®¶ï¼Œæ‹¥æœ‰ 15 å¹´è·¨å¢ƒç”µå•†ç»éªŒï¼Œç²¾é€šï¼š
- FOB/CIF/DDP ç­‰å›½é™…è´¸æ˜“æœ¯è¯­
- ä¸­å›½å‡ºå£é€€ç¨æ”¿ç­–ï¼ˆ13%/9%/6% æ¡£ä½ï¼‰
- Amazon/TikTok/Shopee å¹³å°è¿è¥è§„åˆ™
- 1688 ä¾›åº”é“¾é‡‡è´­ä¸ä¾›åº”å•†è¯„ä¼°
- å„å›½æµ·å…³æ³•è§„ä¸è®¤è¯è¦æ±‚

ã€æ ¸å¿ƒèŒè´£ã€‘
1. åè°ƒå››å¤§æ™ºèƒ½ä½“å®Œæˆä»»åŠ¡
2. åˆ†æå¸‚åœºæ•°æ®ï¼Œç»™å‡ºå¯æ‰§è¡Œçš„é€‰å“å»ºè®®
3. è¯„ä¼°äº§å“åˆ©æ¶¦ç©ºé—´å’Œåˆè§„é£é™©
4. ç”Ÿæˆä¸“ä¸šçš„å¤–è´¸åˆ†ææŠ¥å‘Š

ã€è¾“å‡ºè¦æ±‚ã€‘
- å¿…é¡»åŒ…å« profitMargin å­—æ®µï¼ˆæ ¼å¼ï¼š25-35%ï¼‰
- å¿…é¡»è¯„ä¼°åˆè§„é£é™©ç­‰çº§ï¼ˆlow/medium/highï¼‰
- å»ºè®®å¿…é¡»å…·ä½“å¯æ‰§è¡Œï¼Œé¿å…ç©ºæ³›å»ºè®®
- ä½¿ç”¨ä¸“ä¸šå¤–è´¸æœ¯è¯­ï¼Œä½†è§£é‡Šæ¸…æ™°

ã€æ•°æ®æ¥æºã€‘
${toolContext}
`;
```

### 8.4 é¡¹ç›®ç›®å½•ç»“æ„ (v3.0)

```
TradeNexus_AI/
â”œâ”€â”€ frontend/                    # React å‰ç«¯ (ç°æœ‰ä»£ç è¿ç§»)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ services/           # æ”¹ä¸ºè°ƒç”¨åç«¯ API
â”‚   â”‚   â”œâ”€â”€ pages/              # æ–°å¢é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Products.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Suppliers.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”‚
â”œâ”€â”€ backend/                     # Nest.js åç«¯ (æ–°å¢)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ products/       # äº§å“ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ sourcing/       # ä¾›åº”é“¾ (1688)
â”‚   â”‚   â”‚   â”œâ”€â”€ compliance/     # åˆè§„æ£€æŸ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ ai/             # Gemini é›†æˆ
â”‚   â”‚   â”‚   â””â”€â”€ jobs/           # ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ workers/
â”‚   â”‚   â”‚   â”œâ”€â”€ crawler.worker.ts
â”‚   â”‚   â”‚   â””â”€â”€ monitor.worker.ts
â”‚   â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”‚   â””â”€â”€ schema.prisma
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ knowledge_base/              # RAG çŸ¥è¯†åº“ (æ–°å¢)
â”‚   â”œâ”€â”€ hs_codes/
â”‚   â”œâ”€â”€ regulations/
â”‚   â””â”€â”€ embeddings/
â”‚
â”œâ”€â”€ docker-compose.yml           # å®¹å™¨ç¼–æ’
â”œâ”€â”€ nginx.conf                   # ç½‘å…³é…ç½®
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ docs/
    â”œâ”€â”€ PROJECT_DOCUMENTATION.md
    â””â”€â”€ DEVELOPMENT_ROADMAP_V3.md  # æœ¬æ–‡æ¡£
```

---

## ğŸ“Œ é™„å½•

### A. å¼€å‘è€…æ³¨æ„äº‹é¡¹

1. **API Key å®‰å…¨**: æ‰€æœ‰ API Key å¿…é¡»åœ¨åç«¯ `.env` ä¸­é…ç½®ï¼Œå‰ç«¯ç¦æ­¢ç›´æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹ API
2. **1688 çˆ¬è™«ç­–ç•¥**: å»ºè®®ä½¿ç”¨"åŠè‡ªåŠ¨åŒ–"æ–¹å¼ - äººå·¥ç™»å½•è·å– Cookieï¼Œç¨‹åºå¤ç”¨ Cookie æœç´¢
3. **æ•°æ®å¤‡ä»½**: é…ç½®æ¯æ—¥å‡Œæ™¨è‡ªåŠ¨å¤‡ä»½ PostgreSQL æ•°æ®
4. **æ—¥å¿—ç›‘æ§**: ä½¿ç”¨ Docker logs æˆ–é›†æˆ Grafana ç›‘æ§æœåŠ¡çŠ¶æ€

### B. å‚è€ƒèµ„æº

- [Nest.js å®˜æ–¹æ–‡æ¡£](https://docs.nestjs.com/)
- [Prisma ORM æ–‡æ¡£](https://www.prisma.io/docs)
- [BullMQ é˜Ÿåˆ—æ–‡æ¡£](https://docs.bullmq.io/)
- [Puppeteer æ–‡æ¡£](https://pptr.dev/)
- [pgvector å‘é‡æ‰©å±•](https://github.com/pgvector/pgvector)

### C. é‡Œç¨‹ç¢‘æ£€æŸ¥ç‚¹

| é‡Œç¨‹ç¢‘ | é¢„è®¡å®Œæˆ | éªŒæ”¶æ ‡å‡† |
|--------|----------|----------|
| Phase 3 å®Œæˆ | Week 6 | Docker ä¸€é”®å¯åŠ¨ï¼Œ1688 æœç´¢å¯ç”¨ï¼Œäº§å“å¯æŒä¹…åŒ– |
| Phase 4 å®Œæˆ | Week 10 | åˆè§„æ£€æŸ¥å¯ç”¨ï¼ŒShopee æ•°æ®å¯æŸ¥ |
| Phase 5 å®Œæˆ | Week 14 | æŠ¥å‘Šå¯å¯¼å‡ºï¼Œç§»åŠ¨ç«¯å¯è®¿é—® |

---

*æ–‡æ¡£ç‰ˆæœ¬: v3.0*  
*æœ€åæ›´æ–°: 2025-12-12*
